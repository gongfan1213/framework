### 06 安全：认证、权限、速率限制

#### 认证（JWT）
```python
from jose import jwt
token = jwt.encode({"sub": user_id}, "secret", algorithm="HS256")
payload = jwt.decode(token, "secret", algorithms=["HS256"])
```

#### 权限模型
- RBAC（角色-权限-资源）、ABAC（属性驱动）；
- 以依赖注入实现 `require_role("admin")`；

#### 速率限制
- 令牌桶/固定窗口；Redis 计数；

#### CORS/Headers
- 严格 `allow_origins`、`allow_credentials`；
- 安全响应头（HSTS/Content-Security-Policy）。


